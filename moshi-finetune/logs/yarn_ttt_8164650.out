==================================================
Job started at: Fri 14 Nov 2025 17:46:29 IST
Running on node: ise-6000-06.auth.ad.bgu.ac.il
GPU info:
Fri Nov 14 17:46:29 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX 6000 Ada Gene...    On  |   00000000:24:00.0 Off |                  Off |
| 30%   44C    P8             23W /  300W |       2MiB /  49140MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==================================================
Set CUDA_VISIBLE_DEVICES=0
Starting YARN + TTT training...
Context Extension: 4x (3000 -> 12000 tokens)
TTT Layers: 3 (layers 10, 20, 30)
Base Model: Frozen (only TTT params trained)
Warning: `hf_repo_id` is set but `config_path` is None. This will load default models.
2025-11-14 17:46:35 (IST) - 0:00:03 - distributed - INFO - torch.cuda.device_count: 1
2025-11-14 17:46:35 (IST) - 0:00:03 - distributed - INFO - CUDA_VISIBLE_DEVICES: 0
2025-11-14 17:46:35 (IST) - 0:00:03 - distributed - INFO - local rank: 0
2025-11-14 17:46:35 (IST) - 0:00:03 - train - INFO - Going to init comms...
2025-11-14 17:46:35 (IST) - 0:00:03 - train - INFO - Run dir: /sise/eliyanac-group/ron_al/ttt_training_run2
2025-11-14 17:46:35 (IST) - 0:00:03 - train - INFO - Removing run dir /sise/eliyanac-group/ron_al/ttt_training_run2...
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field data: {'train_data': '/sise/eliyanac-group/ron_al/talkbank_callhome_english/talkbank.jsonl', 'shuffle': False, 'eval_data': ''}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field moshi_paths: {'hf_repo_id': 'kyutai/moshiko-pytorch-bf16', 'mimi_path': None, 'moshi_path': None, 'tokenizer_path': None, 'config_path': None}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field optim: {'lr': 0.0001, 'weight_decay': 0.1, 'pct_start': 0.05}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field wandb: {'project': 'moshi_in_place', 'offline': False, 'key': '', 'run_name': 'run2'}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field lora: {'enable': False, 'rank': 64, 'scaling': 2.0, 'ft_embed': False}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field ttt: {'enabled': True, 'layer_frequency': 10, 'start_layer': 10, 'chunk_size': 256, 'learning_rate': 0.0001, 'conv_kernel_size': 2, 'delta_clip_fro_norm': 100.0, 'unfreeze_ttt_layers': False}
2025-11-14 17:46:35 (IST) - 0:00:04 - simple_parsing.helpers.serialization.serializable - DEBUG - Encoded dataclass field yarn: {'enabled': True, 'scale': 4.0, 'original_max_seq_len': 3000, 'beta_fast': 32, 'beta_slow': 1, 'mscale': 1.0, 'mscale_all_dim': 0.0}
2025-11-14 17:46:35 (IST) - 0:00:04 - train - INFO - TrainArgs: {'batch_size': 2,
 'ckpt_freq': 100,
 'data': {'eval_data': '',
          'shuffle': False,
          'train_data': '/sise/eliyanac-group/ron_al/talkbank_callhome_english/talkbank.jsonl'},
 'do_ckpt': True,
 'do_eval': False,
 'duration_sec': 150.0,
 'eval_freq': 100,
 'first_codebook_weight_multiplier': 100.0,
 'full_finetuning': False,
 'gradient_checkpointing': True,
 'log_freq': 1,
 'lora': {'enable': False, 'ft_embed': False, 'rank': 64, 'scaling': 2.0},
 'max_norm': 1.0,
 'max_steps': 2000,
 'moshi_paths': {'config_path': None,
                 'hf_repo_id': 'kyutai/moshiko-pytorch-bf16',
                 'mimi_path': None,
                 'moshi_path': None,
                 'tokenizer_path': None},
 'num_ckpt_keep': 3,
 'num_microbatches': 1,
 'optim': {'lr': 0.0001, 'pct_start': 0.05, 'weight_decay': 0.1},
 'overwrite_run_dir': True,
 'param_dtype': 'bfloat16',
 'run_dir': '/sise/eliyanac-group/ron_al/ttt_training_run2',
 'save_adapters': True,
 'seed': 0,
 'text_padding_weight': 0.5,
 'ttt': {'chunk_size': 256,
         'conv_kernel_size': 2,
         'delta_clip_fro_norm': 100.0,
         'enabled': True,
         'layer_frequency': 10,
         'learning_rate': 0.0001,
         'start_layer': 10,
         'unfreeze_ttt_layers': False},
 'wandb': {'key': '',
           'offline': False,
           'project': 'moshi_in_place',
           'run_name': 'run2'},
 'world_size': 1,
 'yarn': {'beta_fast': 32,
          'beta_slow': 1,
          'enabled': True,
          'mscale': 1.0,
          'mscale_all_dim': 0.0,
          'original_max_seq_len': 3000,
          'scale': 4.0}}
2025-11-14 17:46:35 (IST) - 0:00:04 - git.util - DEBUG - sys.platform='linux', git_executable='git'
2025-11-14 17:46:35 (IST) - 0:00:04 - git.cmd - DEBUG - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/alufr/moshi_in_place_ttt/moshi_in_place, stdin=None, shell=False, universal_newlines=False)
2025-11-14 17:46:36 (IST) - 0:00:04 - metrics_logger - INFO - initializing wandb
2025-11-14 17:46:36 (IST) - 0:00:04 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.wandb.ai:443
2025-11-14 17:46:36 (IST) - 0:00:04 - urllib3.connectionpool - DEBUG - https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
2025-11-14 17:46:36 (IST) - 0:00:04 - urllib3.connectionpool - DEBUG - https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 395
2025-11-14 17:46:36 (IST) - 0:00:04 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): o151352.ingest.sentry.io:443
==================================================
Job finished at: Fri 14 Nov 2025 17:46:38 IST
==================================================
