==================================================
Job started at: Fri 14 Nov 2025 17:18:34 IST
Running on node: ise-6000-03.auth.ad.bgu.ac.il
GPU info:
Fri Nov 14 17:18:34 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX 6000 Ada Gene...    On  |   00000000:23:00.0 Off |                  Off |
| 30%   27C    P8             24W /  300W |       2MiB /  49140MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==================================================
Set CUDA_VISIBLE_DEVICES=0
Starting YARN + TTT training...
Context Extension: 4x (3000 -> 12000 tokens)
TTT Layers: 3 (layers 10, 20, 30)
Base Model: Frozen (only TTT params trained)
Warning: `hf_repo_id` is set but `config_path` is None. This will load default models.
2025-11-14 17:18:41 (IST) - 0:00:04 - distributed - INFO - torch.cuda.device_count: 1
2025-11-14 17:18:41 (IST) - 0:00:04 - distributed - INFO - CUDA_VISIBLE_DEVICES: 0
2025-11-14 17:18:41 (IST) - 0:00:04 - distributed - INFO - local rank: 0
2025-11-14 17:18:41 (IST) - 0:00:04 - train - INFO - Going to init comms...
2025-11-14 17:18:41 (IST) - 0:00:04 - train - INFO - Run dir: /sise/eliyanac-group/ron_al/ttt_training_run2
2025-11-14 17:18:41 (IST) - 0:00:04 - train - INFO - Removing run dir /sise/eliyanac-group/ron_al/ttt_training_run2...
2025-11-14 17:18:41 (IST) - 0:00:04 - train - INFO - TrainArgs: {'batch_size': 2,
 'ckpt_freq': 100,
 'data': {'eval_data': '',
          'shuffle': False,
          'train_data': '/sise/eliyanac-group/ron_al/talkbank_callhome_english/talkbank.jsonl'},
 'do_ckpt': True,
 'do_eval': False,
 'duration_sec': 150.0,
 'eval_freq': 100,
 'first_codebook_weight_multiplier': 100.0,
 'full_finetuning': False,
 'gradient_checkpointing': True,
 'log_freq': 1,
 'lora': {'enable': False, 'ft_embed': False, 'rank': 64, 'scaling': 2.0},
 'max_norm': 1.0,
 'max_steps': 2000,
 'moshi_paths': {'config_path': None,
                 'hf_repo_id': 'kyutai/moshiko-pytorch-bf16',
                 'mimi_path': None,
                 'moshi_path': None,
                 'tokenizer_path': None},
 'num_ckpt_keep': 3,
 'num_microbatches': 1,
 'optim': {'lr': 0.0001, 'pct_start': 0.05, 'weight_decay': 0.1},
 'overwrite_run_dir': True,
 'param_dtype': 'bfloat16',
 'run_dir': '/sise/eliyanac-group/ron_al/ttt_training_run2',
 'save_adapters': True,
 'seed': 0,
 'text_padding_weight': 0.5,
 'ttt': {'chunk_size': 256,
         'conv_kernel_size': 2,
         'delta_clip_fro_norm': 100.0,
         'enabled': True,
         'layer_frequency': 10,
         'learning_rate': 0.0001,
         'start_layer': 10,
         'unfreeze_ttt_layers': False},
 'wandb': {'key': '',
           'offline': False,
           'project': 'moshi_in_place',
           'run_name': 'run2'},
 'world_size': 1,
 'yarn': {'beta_fast': 32,
          'beta_slow': 1,
          'enabled': True,
          'mscale': 1.0,
          'mscale_all_dim': 0.0,
          'original_max_seq_len': 3000,
          'scale': 4.0}}
2025-11-14 17:18:41 (IST) - 0:00:04 - metrics_logger - INFO - initializing wandb
2025-11-14 17:18:44 (IST) - 0:00:07 - train - INFO - Loading Mimi and Moshi...
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - TTT (Test-Time Training) ENABLED
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Layer frequency: 10
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Start layer: 10
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Chunk size: 256
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Learning rate: 0.0001
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Conv kernel: 2
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - YaRN (Context Window Extension) ENABLED
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Scale: 4.0x
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Original max seq len: 3000
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Beta fast: 32
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   Beta slow: 1
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - ======================================================================
[YaRN] Enabled with scale=4.0, original_len=3000
[TTT] Enabled TTT gating: chunk_size=256, lr=0.0001, dim=4096, hidden=11264
[TTT] Enabled TTT gating: chunk_size=256, lr=0.0001, dim=4096, hidden=11264
[TTT] Enabled TTT gating: chunk_size=256, lr=0.0001, dim=4096, hidden=11264
[YaRN] Initializing RoPE buffers on device=meta
[YaRN] RoPE buffers initialized successfully
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - Converting model to dtype torch.bfloat16 ...
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - Initializing TTT w_down from pretrained checkpoint...
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   ✓ transformer.layers.10.gating.w_down <- transformer.layers.10.gating.linear_out.weight (shape: torch.Size([4096, 11264]), dtype: float32)
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   ✓ transformer.layers.20.gating.w_down <- transformer.layers.20.gating.linear_out.weight (shape: torch.Size([4096, 11264]), dtype: float32)
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO -   ✓ transformer.layers.30.gating.w_down <- transformer.layers.30.gating.linear_out.weight (shape: torch.Size([4096, 11264]), dtype: float32)
2025-11-14 17:18:45 (IST) - 0:00:08 - finetune.wrapped_model - INFO - Initializing TTT layers ...
2025-11-14 17:18:46 (IST) - 0:00:09 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.10.gating.target_generator.conv1d.conv.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:46 (IST) - 0:00:09 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.10.gating.target_generator.W_target.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:46 (IST) - 0:00:09 - finetune.wrapped_model - INFO -   ✓ Initialized transformer.layers.10.gating.w_down_pretrained from w_down
2025-11-14 17:18:46 (IST) - 0:00:09 - finetune.wrapped_model - WARNING - Buffer transformer.layers.10.gating.ttt_clip_event_counter still meta - initializing as zeros
2025-11-14 17:18:47 (IST) - 0:00:10 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.20.gating.target_generator.conv1d.conv.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:47 (IST) - 0:00:10 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.20.gating.target_generator.W_target.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:47 (IST) - 0:00:10 - finetune.wrapped_model - INFO -   ✓ Initialized transformer.layers.20.gating.w_down_pretrained from w_down
2025-11-14 17:18:47 (IST) - 0:00:10 - finetune.wrapped_model - WARNING - Buffer transformer.layers.20.gating.ttt_clip_event_counter still meta - initializing as zeros
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.30.gating.target_generator.conv1d.conv.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO -   ✓ Small-random-initialized transformer.layers.30.gating.target_generator.W_target.weight (std=1e-4) for warm-start with gradient flow
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO -   ✓ Initialized transformer.layers.30.gating.w_down_pretrained from w_down
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - WARNING - Buffer transformer.layers.30.gating.ttt_clip_event_counter still meta - initializing as zeros
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - Initializing YaRN RoPE buffers ...
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO -   ✓ Initialized transformer.rope.inv_freq (shape: torch.Size([64]), scale: 4.0x)
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - Finished initialization!
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - TTT ACTIVE: 3 layers enabled
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - TTT layer indices: [10, 20, 30]
2025-11-14 17:18:48 (IST) - 0:00:11 - finetune.wrapped_model - INFO - ======================================================================
2025-11-14 17:18:54 (IST) - 0:00:17 - train - INFO - [DocStream] step=1 microbatch=0 samples=2 unique_docs=1 runs=0638.wav[segments=0-1]
2025-11-14 17:18:54 (IST) - 0:00:17 - train - INFO - [TTT RESET] Document switch detected: None -> /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/0638.wav
2025-11-14 17:18:54 (IST) - 0:00:17 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 71.500000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:18:54 (IST) - 0:00:17 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.982422, w_down norm 73.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:18:54 (IST) - 0:00:17 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 74.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - 
=== TTT Parameter Debug ===
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.10.gating.w_down:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.367005
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.10.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.10.gating.target_generator.W_target.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.20.gating.w_down:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.483787
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.20.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.20.gating.target_generator.W_target.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.30.gating.w_down:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.794516
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.30.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - transformer.layers.30.gating.target_generator.W_target.weight:
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   requires_grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   has grad: True
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - =========================

2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - [TTT] Step 1: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=4.697e-02, relative_change=0.0373% (9 params)
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - step: 000001 - done (%): 0.1 - loss: 3.378 - lr: 4.0e-06 - peak_alloc_mem (GB): 36.0 - alloc_mem (GB): 21.0 - words_per_second: 2831.8 - avg_words_per_second: 2831.8 - ETA: >2025-11-14 23:56:07
2025-11-14 17:19:02 (IST) - 0:00:25 - train - INFO - [DocStream] step=2 microbatch=0 samples=2 unique_docs=1 runs=0638.wav[segments=2-3]
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - 
=== TTT Parameter Debug ===
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.10.gating.w_down:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.375022
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.10.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.10.gating.target_generator.W_target.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.20.gating.w_down:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.494800
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.20.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.20.gating.target_generator.W_target.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.30.gating.w_down:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.783920
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.30.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - transformer.layers.30.gating.target_generator.W_target.weight:
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   requires_grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   has grad: True
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - =========================

2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - [TTT] Step 2: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=3.899e-02, relative_change=0.0310% (9 params)
2025-11-14 17:19:08 (IST) - 0:00:31 - train - INFO - step: 000002 - done (%): 0.1 - loss: 3.931 - lr: 4.0e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5470.1 - avg_words_per_second: 3731.7 - ETA: >2025-11-14 22:20:18
2025-11-14 17:19:09 (IST) - 0:00:32 - train - INFO - [DocStream] step=3 microbatch=0 samples=2 unique_docs=1 runs=0638.wav[segments=4-5]
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - 
=== TTT Parameter Debug ===
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.10.gating.w_down:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.405880
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.10.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.10.gating.target_generator.W_target.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.20.gating.w_down:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.506595
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.20.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.20.gating.target_generator.W_target.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.30.gating.w_down:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.760672
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.30.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - transformer.layers.30.gating.target_generator.W_target.weight:
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   requires_grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   has grad: True
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - =========================

2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - [TTT] Step 3: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=3.553e-02, relative_change=0.0282% (9 params)
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - step: 000003 - done (%): 0.1 - loss: 3.342 - lr: 4.1e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5058.9 - avg_words_per_second: 4089.3 - ETA: >2025-11-14 21:53:57
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - [DocStream] step=4 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=0-1]
2025-11-14 17:19:15 (IST) - 0:00:38 - train - INFO - [TTT RESET] Document switch detected: /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/0638.wav -> /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4065.wav
2025-11-14 17:19:15 (IST) - 0:00:38 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 71.500000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:15 (IST) - 0:00:38 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.982422, w_down norm 73.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:15 (IST) - 0:00:38 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 74.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - 
=== TTT Parameter Debug ===
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.10.gating.w_down:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.406482
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.10.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.10.gating.target_generator.W_target.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.20.gating.w_down:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.474131
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.20.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.20.gating.target_generator.W_target.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.30.gating.w_down:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.781006
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.30.gating.target_generator.conv1d.conv.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - transformer.layers.30.gating.target_generator.W_target.weight:
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   requires_grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   has grad: True
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO -   grad norm: 0.000000
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - =========================

2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - [TTT] Step 4: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=3.321e-02, relative_change=0.0264% (9 params)
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - step: 000004 - done (%): 0.2 - loss: 4.809 - lr: 4.2e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5406.5 - avg_words_per_second: 4354.5 - ETA: >2025-11-14 21:37:11
2025-11-14 17:19:21 (IST) - 0:00:44 - train - INFO - [DocStream] step=5 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=2-3]
2025-11-14 17:19:27 (IST) - 0:00:50 - train - INFO - [TTT] Step 5: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=3.228e-02, relative_change=0.0256% (9 params)
2025-11-14 17:19:27 (IST) - 0:00:50 - train - INFO - step: 000005 - done (%): 0.2 - loss: 4.887 - lr: 4.4e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5376.6 - avg_words_per_second: 4526.7 - ETA: >2025-11-14 21:27:22
2025-11-14 17:19:28 (IST) - 0:00:51 - train - INFO - [DocStream] step=6 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=4-5]
2025-11-14 17:19:34 (IST) - 0:00:57 - train - INFO - [TTT] Step 6: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.241e-02, relative_change=0.0257% (9 params)
2025-11-14 17:19:34 (IST) - 0:00:57 - train - INFO - step: 000006 - done (%): 0.3 - loss: 3.288 - lr: 4.6e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5335.4 - avg_words_per_second: 4644.0 - ETA: >2025-11-14 21:21:05
2025-11-14 17:19:34 (IST) - 0:00:57 - train - INFO - [DocStream] step=7 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=6-7]
2025-11-14 17:19:40 (IST) - 0:01:03 - train - INFO - [TTT] Step 7: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.159e-02, relative_change=0.0251% (9 params)
2025-11-14 17:19:40 (IST) - 0:01:03 - train - INFO - step: 000007 - done (%): 0.3 - loss: 2.585 - lr: 4.9e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5316.1 - avg_words_per_second: 4729.4 - ETA: >2025-11-14 21:16:43
2025-11-14 17:19:40 (IST) - 0:01:03 - train - INFO - [DocStream] step=8 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=8-9]
2025-11-14 17:19:46 (IST) - 0:01:09 - train - INFO - [TTT] Step 8: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.187e-02, relative_change=0.0253% (9 params)
2025-11-14 17:19:46 (IST) - 0:01:09 - train - INFO - step: 000008 - done (%): 0.4 - loss: 2.288 - lr: 5.2e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5307.5 - avg_words_per_second: 4794.7 - ETA: >2025-11-14 21:13:28
2025-11-14 17:19:47 (IST) - 0:01:10 - train - INFO - [DocStream] step=9 microbatch=0 samples=2 unique_docs=1 runs=4065.wav[segments=10-11]
2025-11-14 17:19:53 (IST) - 0:01:16 - train - INFO - [TTT] Step 9: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.217e-02, relative_change=0.0255% (9 params)
2025-11-14 17:19:53 (IST) - 0:01:16 - train - INFO - step: 000009 - done (%): 0.5 - loss: 2.285 - lr: 5.5e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5293.9 - avg_words_per_second: 4845.4 - ETA: >2025-11-14 21:11:01
2025-11-14 17:19:53 (IST) - 0:01:16 - train - INFO - [DocStream] step=10 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=0-1]
2025-11-14 17:19:53 (IST) - 0:01:16 - train - INFO - [TTT RESET] Document switch detected: /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4065.wav -> /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4074.wav
2025-11-14 17:19:53 (IST) - 0:01:16 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 71.500000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:53 (IST) - 0:01:16 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.982422, w_down norm 73.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:53 (IST) - 0:01:16 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 74.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:19:59 (IST) - 0:01:22 - train - INFO - [TTT] Step 10: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.309e-02, relative_change=0.0263% (9 params)
2025-11-14 17:19:59 (IST) - 0:01:22 - train - INFO - step: 000010 - done (%): 0.5 - loss: 5.038 - lr: 5.9e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5270.1 - avg_words_per_second: 4884.8 - ETA: >2025-11-14 21:09:09
2025-11-14 17:20:00 (IST) - 0:01:22 - train - INFO - [DocStream] step=11 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=2-3]
2025-11-14 17:20:06 (IST) - 0:01:29 - train - INFO - [TTT] Step 11: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.393e-02, relative_change=0.0269% (9 params)
2025-11-14 17:20:06 (IST) - 0:01:29 - train - INFO - step: 000011 - done (%): 0.6 - loss: 4.505 - lr: 6.4e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5266.0 - avg_words_per_second: 4917.2 - ETA: >2025-11-14 21:07:38
2025-11-14 17:20:06 (IST) - 0:01:29 - train - INFO - [DocStream] step=12 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=4-5]
2025-11-14 17:20:12 (IST) - 0:01:35 - train - INFO - [TTT] Step 12: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.510e-02, relative_change=0.0279% (9 params)
2025-11-14 17:20:12 (IST) - 0:01:35 - train - INFO - step: 000012 - done (%): 0.6 - loss: 2.670 - lr: 6.9e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5247.3 - avg_words_per_second: 4943.1 - ETA: >2025-11-14 21:06:26
2025-11-14 17:20:12 (IST) - 0:01:35 - train - INFO - [DocStream] step=13 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=6-7]
2025-11-14 17:20:19 (IST) - 0:01:41 - train - INFO - [TTT] Step 13: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.584e-02, relative_change=0.0285% (9 params)
2025-11-14 17:20:19 (IST) - 0:01:41 - train - INFO - step: 000013 - done (%): 0.7 - loss: 3.057 - lr: 7.4e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5240.1 - avg_words_per_second: 4964.7 - ETA: >2025-11-14 21:05:26
2025-11-14 17:20:19 (IST) - 0:01:42 - train - INFO - [DocStream] step=14 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=8-9]
2025-11-14 17:20:25 (IST) - 0:01:48 - train - INFO - [TTT] Step 14: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=3.766e-02, relative_change=0.0299% (9 params)
2025-11-14 17:20:25 (IST) - 0:01:48 - train - INFO - step: 000014 - done (%): 0.7 - loss: 2.874 - lr: 8.0e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5218.9 - avg_words_per_second: 4982.1 - ETA: >2025-11-14 21:04:39
2025-11-14 17:20:25 (IST) - 0:01:48 - train - INFO - [DocStream] step=15 microbatch=0 samples=2 unique_docs=1 runs=4074.wav[segments=10-11]
2025-11-14 17:20:32 (IST) - 0:01:54 - train - INFO - [TTT] Step 15: grad_norm=1.000e+00, param_norm=125.9591, delta_norm=4.056e-02, relative_change=0.0322% (9 params)
2025-11-14 17:20:32 (IST) - 0:01:54 - train - INFO - step: 000015 - done (%): 0.8 - loss: 2.740 - lr: 8.7e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5211.9 - avg_words_per_second: 4996.8 - ETA: >2025-11-14 21:03:59
2025-11-14 17:20:32 (IST) - 0:01:55 - train - INFO - [DocStream] step=16 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=0-1]
2025-11-14 17:20:32 (IST) - 0:01:55 - train - INFO - [TTT RESET] Document switch detected: /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4074.wav -> /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4077.wav
2025-11-14 17:20:32 (IST) - 0:01:55 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 71.500000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:20:32 (IST) - 0:01:55 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.982422, w_down norm 73.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:20:32 (IST) - 0:01:55 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 74.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:20:38 (IST) - 0:02:01 - train - INFO - [TTT] Step 16: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=4.208e-02, relative_change=0.0334% (9 params)
2025-11-14 17:20:38 (IST) - 0:02:01 - train - INFO - step: 000016 - done (%): 0.8 - loss: 4.238 - lr: 9.3e-06 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5221.2 - avg_words_per_second: 5010.2 - ETA: >2025-11-14 21:03:23
2025-11-14 17:20:38 (IST) - 0:02:01 - train - INFO - [DocStream] step=17 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=2-3]
2025-11-14 17:20:44 (IST) - 0:02:07 - train - INFO - [TTT] Step 17: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=4.259e-02, relative_change=0.0338% (9 params)
2025-11-14 17:20:44 (IST) - 0:02:07 - train - INFO - step: 000017 - done (%): 0.8 - loss: 3.717 - lr: 1.0e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5195.5 - avg_words_per_second: 5020.7 - ETA: >2025-11-14 21:02:54
2025-11-14 17:20:45 (IST) - 0:02:08 - train - INFO - [DocStream] step=18 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=4-5]
2025-11-14 17:20:51 (IST) - 0:02:14 - train - INFO - [TTT] Step 18: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=4.323e-02, relative_change=0.0343% (9 params)
2025-11-14 17:20:51 (IST) - 0:02:14 - train - INFO - step: 000018 - done (%): 0.9 - loss: 2.476 - lr: 1.1e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5208.9 - avg_words_per_second: 5030.8 - ETA: >2025-11-14 21:02:27
2025-11-14 17:20:51 (IST) - 0:02:14 - train - INFO - [DocStream] step=19 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=6-7]
2025-11-14 17:20:57 (IST) - 0:02:20 - train - INFO - [TTT] Step 19: grad_norm=1.000e+00, param_norm=125.9592, delta_norm=4.479e-02, relative_change=0.0356% (9 params)
2025-11-14 17:20:57 (IST) - 0:02:20 - train - INFO - step: 000019 - done (%): 0.9 - loss: 3.770 - lr: 1.2e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5192.3 - avg_words_per_second: 5039.1 - ETA: >2025-11-14 21:02:05
2025-11-14 17:20:58 (IST) - 0:02:21 - train - INFO - [DocStream] step=20 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=8-9]
2025-11-14 17:21:04 (IST) - 0:02:27 - train - INFO - [TTT] Step 20: grad_norm=1.000e+00, param_norm=125.9593, delta_norm=4.732e-02, relative_change=0.0376% (9 params)
2025-11-14 17:21:04 (IST) - 0:02:27 - train - INFO - step: 000020 - done (%): 1.0 - loss: 3.360 - lr: 1.2e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5180.1 - avg_words_per_second: 5046.0 - ETA: >2025-11-14 21:01:47
2025-11-14 17:21:04 (IST) - 0:02:27 - train - INFO - [DocStream] step=21 microbatch=0 samples=2 unique_docs=1 runs=4077.wav[segments=10-11]
2025-11-14 17:21:10 (IST) - 0:02:33 - train - INFO - [TTT] Step 21: grad_norm=1.000e+00, param_norm=125.9593, delta_norm=5.017e-02, relative_change=0.0398% (9 params)
2025-11-14 17:21:10 (IST) - 0:02:33 - train - INFO - step: 000021 - done (%): 1.1 - loss: 1.916 - lr: 1.3e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5178.9 - avg_words_per_second: 5052.1 - ETA: >2025-11-14 21:01:31
2025-11-14 17:21:11 (IST) - 0:02:34 - train - INFO - [DocStream] step=22 microbatch=0 samples=2 unique_docs=1 runs=4092.wav[segments=0-1]
2025-11-14 17:21:11 (IST) - 0:02:34 - train - INFO - [TTT RESET] Document switch detected: /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4077.wav -> /sise/eliyanac-group/ron_al/talkbank_callhome_english/wav/4092.wav
2025-11-14 17:21:11 (IST) - 0:02:34 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 71.500000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:21:11 (IST) - 0:02:34 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.982422, w_down norm 73.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:21:11 (IST) - 0:02:34 - moshi.modules.ttt_module - INFO - [TTT RESET][train] target_generator norm 0.980469, w_down norm 74.000000 (dtype: torch.bfloat16); both learn via backprop during training
2025-11-14 17:21:17 (IST) - 0:02:40 - train - INFO - [TTT] Step 22: grad_norm=1.000e+00, param_norm=125.9594, delta_norm=5.325e-02, relative_change=0.0423% (9 params)
2025-11-14 17:21:17 (IST) - 0:02:40 - train - INFO - step: 000022 - done (%): 1.1 - loss: 3.864 - lr: 1.4e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5165.2 - avg_words_per_second: 5057.2 - ETA: >2025-11-14 21:01:18
2025-11-14 17:21:17 (IST) - 0:02:40 - train - INFO - [DocStream] step=23 microbatch=0 samples=2 unique_docs=1 runs=4092.wav[segments=2-3]
2025-11-14 17:21:24 (IST) - 0:02:46 - train - INFO - [TTT] Step 23: grad_norm=1.000e+00, param_norm=125.9594, delta_norm=5.357e-02, relative_change=0.0425% (9 params)
2025-11-14 17:21:24 (IST) - 0:02:46 - train - INFO - step: 000023 - done (%): 1.1 - loss: 3.616 - lr: 1.5e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5167.4 - avg_words_per_second: 5061.9 - ETA: >2025-11-14 21:01:05
2025-11-14 17:21:24 (IST) - 0:02:47 - train - INFO - [DocStream] step=24 microbatch=0 samples=2 unique_docs=1 runs=4092.wav[segments=4-5]
2025-11-14 17:21:30 (IST) - 0:02:53 - train - INFO - [TTT] Step 24: grad_norm=1.000e+00, param_norm=125.9595, delta_norm=5.644e-02, relative_change=0.0448% (9 params)
2025-11-14 17:21:30 (IST) - 0:02:53 - train - INFO - step: 000024 - done (%): 1.2 - loss: 2.440 - lr: 1.6e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5172.6 - avg_words_per_second: 5066.4 - ETA: >2025-11-14 21:00:53
2025-11-14 17:21:30 (IST) - 0:02:53 - train - INFO - [DocStream] step=25 microbatch=0 samples=2 unique_docs=1 runs=4092.wav[segments=6-7]
2025-11-14 17:21:37 (IST) - 0:02:59 - train - INFO - [TTT] Step 25: grad_norm=1.000e+00, param_norm=125.9596, delta_norm=5.940e-02, relative_change=0.0472% (9 params)
2025-11-14 17:21:37 (IST) - 0:02:59 - train - INFO - step: 000025 - done (%): 1.2 - loss: 2.450 - lr: 1.7e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5164.2 - avg_words_per_second: 5070.2 - ETA: >2025-11-14 21:00:43
2025-11-14 17:21:37 (IST) - 0:03:00 - train - INFO - [DocStream] step=26 microbatch=0 samples=2 unique_docs=1 runs=4092.wav[segments=8-9]
2025-11-14 17:21:43 (IST) - 0:03:06 - train - INFO - [TTT] Step 26: grad_norm=8.320e-01, param_norm=125.9597, delta_norm=6.347e-02, relative_change=0.0504% (9 params)
2025-11-14 17:21:43 (IST) - 0:03:06 - train - INFO - step: 000026 - done (%): 1.3 - loss: 1.704 - lr: 1.8e-05 - peak_alloc_mem (GB): 39.3 - alloc_mem (GB): 21.0 - words_per_second: 5166.3 - avg_words_per_second: 5073.8 - ETA: >2025-11-14 21:00:34
2025-11-14 17:21:43 (IST) - 0:03:06 - utils - INFO - Closing: eval_logger
2025-11-14 17:21:45 (IST) - 0:03:08 - utils - INFO - Closed: eval_logger
2025-11-14 17:21:45 (IST) - 0:03:08 - utils - INFO - Closing: metrics_logger
2025-11-14 17:21:45 (IST) - 0:03:08 - utils - ERROR - Error while closing metrics_logger!
==================================================
Job finished at: Fri 14 Nov 2025 17:21:48 IST
==================================================
